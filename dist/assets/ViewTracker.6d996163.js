import{A as b,C as S,r as h,B as D,o as u,c as d,a as e,h as T,F as C,g as E,t as v,H as A,I as R,y as x,D as I,z as L,J as j,i as M,p as B,d as K,E as z,b as f}from"./index.e8fa8bee.js";import{T as N,_ as V}from"./BaseHeading.181f477a.js";import{p as P}from"./index.2d0901d5.js";import{_ as U}from"./plugin-vue_export-helper.21dcd24c.js";import"./logo.bccff2c0.js";const F="/api/log/add-entry",H="/api/log/edit-entry",q="/api/log/view-logs",J="/api/log/remove";var w={TRACKER_ADD:F,TRACKER_EDIT:H,TRACKER_LIST:q,TRACKER_DELETE:J};const O=async(a,s)=>await b.post(w.TRACKER_ADD,a,{headers:{Authorization:s}}),W=async(a,s,n)=>await b.post(`${w.TRACKER_EDIT}/${n}`,a,{headers:{Authorization:s}}),Y=async(a,s)=>await b.get(`${w.TRACKER_LIST}/${s}`,{headers:{authorization:a}}),G=async(a,s)=>await b.get(`${w.TRACKER_DELETE}/${s}`,{headers:{authorization:a}});function Q(a){return a.sort((s,n)=>new Date(n.end_time)-new Date(s.end_time)),a}const X={class:"mt-3 border border-bottom-0 rounded"},Z={class:"table table-hover"},tt=e("thead",{class:"text-primary"},[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Activity Name"),e("th",{scope:"col"},"Project Id"),e("th",{scope:"col"},"Billability"),e("th",{scope:"col"},"Start Time"),e("th",{scope:"col"},"End Time"),e("th",{scope:"col"},"Action"),e("th",{scope:"col"},"Total Time"),e("th",{scope:"col"})])],-1),et={key:0},at={key:1},ot=["textContent"],nt=["textContent"],st=["textContent"],rt=["textContent"],lt=["textContent"],it=["textContent"],ct=e("button",{class:"btn btn-light btn-sm"},"Edit",-1),ut=["onClick"],dt={setup(a){const s=S(),n=h([]),i=h(!0),l=D().user.id;async function _(){try{const c=await Y(s,l);n.value=c.data.logs,Q(n.value),i.value=!1}catch{alert("Something went wrong, please try again later")}}_();async function p(c){try{(await G(s,c)).status===200&&(alert("Timelog deleted successfully"),_())}catch{alert("Something went wrong, please try again later")}}function m(c,o){const t=new Date(o)-new Date(c);return new Date(t)}function y(c){return c.toString().padStart(2,"0")}function $(c){let o=Math.floor(c/1e3),t=Math.floor(o/60),r=Math.floor(t/60);return o=o%60,t=o>=30?t+1:t,t=t%60,r=r%24,`${y(r)}:${y(t)}:${y(o)}`}return(c,o)=>(u(),d("div",X,[e("table",Z,[tt,i.value?(u(),d("p",et,"Loading...")):T("",!0),n.value.length?(u(),d("tbody",at,[(u(!0),d(C,null,E(n.value,(t,r)=>(u(),d("tr",{key:t.id},[e("th",{scope:"row",textContent:v(`${r+1}`)},null,8,ot),e("td",{textContent:v(t.activity_name)},null,8,nt),e("td",{textContent:v(t.project_id)},null,8,st),e("td",{textContent:v(t.billable)},null,8,rt),e("td",{textContent:v(t.start_time)},null,8,lt),e("td",{textContent:v(t.end_time)},null,8,it),e("td",null,[ct,e("button",{class:"btn btn-light btn-sm mx-2",onClick:g=>p(t.id)}," Delete ",8,ut)]),e("td",null,v($(m(t.start_time,t.end_time))),1)]))),128))])):T("",!0)])]))}};function k(){const a=new Date,s=a.getFullYear();let n=a.getMonth()+1,i=a.getDate(),l=a.getHours(),_=a.getMinutes(),p=a.getSeconds();return n=n<10?`0${n}`:n,i=i<10?`0${i}`:i,l=l<10?`0${l}`:l,_=_<10?`0${_}`:_,p=p<10?`0${p}`:p,`${s}-${n}-${i} ${l}:${_}:${p}`}const _t=a=>(B("data-v-6f8ddf4d"),a=a(),K(),a),pt={class:"tracker px-3 py-2 border rounded shadow-sm"},mt=["onSubmit"],ht=_t(()=>e("label",{for:"project",class:"px-3"},"Projects",-1)),vt=["value","textContent"],yt={key:1,class:"text-danger"},gt=["title"],ft={key:2,type:"submit",class:"btn btn-secondary mb-2"},Tt={setup(a){const s=h(""),n=h(""),i=h([]),l=h(!1),_=h(!0),p=h(!1),m=h(null),y=S();A(async()=>{try{const o=await P(y);o.status===200&&(i.value=o.data.users)}catch{alert("Something went wrong, please try again later")}}),R(n,()=>{i.value.forEach(o=>{o.id===n.value&&(l.value=o.billable)})});async function $(){const o=k(),t=D().user.id,r={activity_name:s.value,user_id:t,project_id:n.value,billable:l.value,start_time:o};try{const g=await O(r,y);g.status===200&&(_.value=!1,p.value=!0,m.value=g.data.log)}catch{alert("Something went wrong, please try again later")}}async function c(){try{const o={activity_name:m.value.activity_name,user_id:m.value.user_id,project_id:m.value.project_id,billable:m.value.billable,start_time:m.value.start_time,end_time:k()};(await W(o,y,m.value.id)).status===200&&(p.value=!1,_.value=!0,s.value="",n.value="",l.value=!1,alert("Time log added successfully"),location.reload())}catch{alert("Something went wrong, please try again later")}}return(o,t)=>(u(),d("div",pt,[e("form",{onSubmit:M($,["prevent"]),class:""},[x(e("input",{type:"text",class:"form-control",id:"description","aria-describedby":"description",placeholder:"What are you working on?","onUpdate:modelValue":t[0]||(t[0]=r=>s.value=r),required:""},null,512),[[I,s.value]]),ht,i.value.length?x((u(),d("select",{key:0,id:"project",class:"form-select","onUpdate:modelValue":t[1]||(t[1]=r=>n.value=r),"aria-label":"projects",required:""},[(u(!0),d(C,null,E(i.value,r=>(u(),d("option",{key:r.id,value:r.id,textContent:v(r.project_name)},null,8,vt))),128))],512)),[[L,n.value]]):(u(),d("span",yt," No projects. ")),e("span",{class:j(["dollar px-3 py-2",{"text-primary":l.value}]),title:l.value?"Billable":"Non billable",onClick:t[2]||(t[2]=r=>l.value=!l.value)}," $ ",10,gt),_.value?(u(),d("button",ft," START ")):T("",!0),p.value?(u(),d("a",{key:3,onClick:c,class:"btn btn-primary text-white mb-2"}," STOP ")):T("",!0)],40,mt)]))}};var bt=U(Tt,[["__scopeId","data-v-6f8ddf4d"]]);const St={setup(a){const s=z();return s.userStatus=!1,(n,i)=>(u(),d(C,null,[f(N),e("main",null,[f(V,{title:"Time Tracker"}),f(bt),f(dt)])],64))}};export{St as default};
