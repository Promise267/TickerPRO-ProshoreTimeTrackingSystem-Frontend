import{A as S,E as V,r as b,D as K,o as r,c as i,a as t,F as C,g as N,t as f,B as w,G as x,u as j,h as g,p as z,d as P,J as q,K as W,C as G,n as J,i as O,H as Y,b as $}from"./index.2f13ce3f.js";import{T as Q,_ as X}from"./BaseHeading.6ba9692b.js";import{_ as F}from"./plugin-vue_export-helper.21dcd24c.js";import{p as Z}from"./index.a2f91efe.js";import"./logo.f5257f33.js";const E="/api/log",tt=E,et=E,at=E,ot=E;var D={TRACKER_ADD:tt,TRACKER_EDIT:et,TRACKER_LIST:at,TRACKER_DELETE:ot};const st=async(e,o)=>await S.post(D.TRACKER_ADD,e,{headers:{Authorization:o}}),H=async(e,o,a)=>await S.patch(`${D.TRACKER_EDIT}/${a}`,e,{headers:{Authorization:o}}),nt=async(e,o)=>await S.get(`${D.TRACKER_LIST}/${o}`,{headers:{authorization:e}}),lt=async(e,o)=>await S.delete(`${D.TRACKER_DELETE}/${o}`,{headers:{authorization:e}});function rt(e){return e.sort((o,a)=>new Date(a.end_time)-new Date(o.end_time)),e}function M(e){return e.toString().padStart(2,"0")}function it(e){let o=Math.floor(e/1e3),a=Math.floor(o/60),l=Math.floor(a/60);return o=o%60,a=o>=30?a+1:a,a=a%60,l=l%24,`${M(l)}:${M(a)}:${M(o)}`}function ct(e,o){const a=new Date(o)-new Date(e);return new Date(a)}const A=e=>(z("data-v-6cb107f3"),e=e(),P(),e),dt={key:0,class:"mt-5 border border-bottom-0 rounded"},ut={class:"table table-hover"},_t=A(()=>t("thead",{class:"text-primary"},[t("tr",null,[t("th",{scope:"col"},"#"),t("th",{scope:"col"},"Activity Name"),t("th",{scope:"col"},"Project Id"),t("th",{scope:"col"},"Billability"),t("th",{scope:"col"},"Start Time"),t("th",{scope:"col"},"End Time"),t("th",{scope:"col"},"Action"),t("th",{scope:"col"},"Total Time"),t("th",{scope:"col"})])],-1)),pt={key:0},mt=["textContent"],ht=["onUpdate:modelValue"],bt=["textContent"],vt=["textContent"],yt={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},ft=["onClick"],gt=["onClick"],Tt=["onUpdate:modelValue"],kt=["onUpdate:modelValue"],wt=["onClick"],$t=A(()=>t("button",{type:"button",class:"btn btn-light btn-sm mx-2","data-bs-toggle":"modal","data-bs-target":"#staticBackdrop"}," Delete ",-1)),xt={class:"modal fade",id:"staticBackdrop","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},Ct={class:"modal-dialog modal-dialog-centered"},St={class:"modal-content"},Et=A(()=>t("div",{class:"modal-header text-center border-0"},[t("h5",{class:"modal-title w-100",id:"staticBackdropLabel"},"Are you sure you want to delete?")],-1)),Dt={class:"modal-footer pull-right justify-content-center border-0"},At=A(()=>t("button",{type:"button",class:"btn btn-secondary-outline","data-bs-dismiss":"modal"},"Cancel",-1)),Bt=["onClick"],Lt={key:1,class:"mt-5 text-danger mx-1"},Rt={key:0},It={key:2},jt={setup(e){const o=V(),a=b([]),l=b(!0),c=K().user.id;async function p(){try{const d=await nt(o,c);d.status===200&&d.data.logs&&(a.value=d.data.logs,rt(a.value)),l.value=!1}catch{alert("Something went wrong, please try again later")}}p();async function m(d,y,s,k,h,B,L){try{var R={activity_name:d,user_id:y,project_id:s,billable:k,start_time:h,end_time:B};(await H(R,o,L)).status==200&&(p(),alert("Time Log Updated Successfully"))}catch{alert("Error: unable to edit the time log.")}}async function v(d){try{(await lt(o,d)).status===200&&(alert("Timelog deleted successfully"),p(),a.value.length===1&&location.reload())}catch{alert("Error: unable to delete the time log.")}}function T(d){return d==!0?"Billable":"Non Billable"}return(d,y)=>(r(),i(C,null,[a.value.length?(r(),i("div",dt,[t("table",ut,[_t,a.value.length?(r(),i("tbody",pt,[(r(!0),i(C,null,N(a.value,(s,k)=>(r(),i("tr",{key:s.id},[t("th",{scope:"row",class:"align-middle",textContent:f(k+1)},null,8,mt),t("td",null,[w(t("input",{class:"edit",type:"text","onUpdate:modelValue":h=>s.activity_name=h},null,8,ht),[[x,s.activity_name]])]),t("td",null,[t("div",{textContent:f(s.project_id)},null,8,bt)]),t("td",null,[t("button",{class:"btn btn-light btn-sm",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown",textContent:f(T(s.billable)),"aria-expanded":"true"},null,8,vt),t("ul",yt,[t("li",null,[t("a",{class:"dropdown-item",onClick:()=>s.billable=!0}," Billable ",8,ft)]),t("li",null,[t("a",{class:"dropdown-item",onClick:()=>s.billable=!1}," Non Billable ",8,gt)])])]),t("td",null,[w(t("input",{class:"edit",type:"text","onUpdate:modelValue":h=>s.start_time=h},null,8,Tt),[[x,s.start_time]])]),t("td",null,[w(t("input",{class:"edit",type:"text","onUpdate:modelValue":h=>s.end_time=h},null,8,kt),[[x,s.end_time]])]),t("td",null,[t("button",{onClick:h=>m(s.activity_name,j(c),s.project_id,s.billable,s.start_time,s.end_time,s.id),class:"btn btn-light btn-sm"}," Edit ",8,wt),$t,t("div",xt,[t("div",Ct,[t("div",St,[Et,t("div",Dt,[At,t("button",{type:"button",class:"btn btn-primary-outline text-primary",onClick:h=>v(s.id),"data-bs-dismiss":"modal"},"Delete",8,Bt)])])])])]),t("td",null,f(j(it)(j(ct)(s.start_time,s.end_time))),1)]))),128))])):g("",!0)])])):(r(),i("p",Lt,[l.value?g("",!0):(r(),i("span",Rt,"No time logs. Let's start tracking"))])),l.value?(r(),i("p",It,"Loading...")):g("",!0)],64))}};var Mt=F(jt,[["__scopeId","data-v-6cb107f3"]]);function U(){const e=new Date,o=e.getFullYear();let a=e.getMonth()+1,l=e.getDate(),c=e.getHours(),p=e.getMinutes(),m=e.getSeconds();return a=a<10?`0${a}`:a,l=l<10?`0${l}`:l,c=c<10?`0${c}`:c,p=p<10?`0${p}`:p,m=m<10?`0${m}`:m,`${o}-${a}-${l} ${c}:${p}:${m}`}const Ut=e=>(z("data-v-a53790dc"),e=e(),P(),e),Vt={class:"tracker px-3 py-2 border rounded shadow-sm"},Kt=["onSubmit"],Nt=Ut(()=>t("label",{for:"project",class:"px-3"},"Projects",-1)),zt=["value","textContent"],Pt={key:1,class:"text-danger"},Ft=["title"],Ht=["textContent"],qt={key:3,type:"submit",class:"btn btn-secondary mb-2 mx-4 mt-2"},Wt={setup(e){const o=b(""),a=b(null),l=b([]),c=b(!1),p=b(!0),m=b(!1),v=b(null),T=b("00:00:00"),d=V();let y=0,s=null;function k(){y++;let n=Math.floor(y/3600),_=Math.floor((y-n*3600)/60),u=y%60;u<10&&(u="0"+u),_<10&&(_="0"+_),n<10&&(n="0"+n),T.value=`${n}:${_}:${u}`}function h(){s||(s=setInterval(k,1e3))}function B(){clearInterval(s),s=null}q(async()=>{try{const n=await Z(d);n.status===200&&(l.value=n.data.users)}catch{alert("Something went wrong, please try again later")}}),W(a,()=>{l.value.forEach(n=>{n.id===a.value&&(c.value=n.billable)})});async function L(){const n=U(),_=K().user.id,u={activity_name:o.value,user_id:_,project_id:a.value,billable:c.value,start_time:n};try{const I=await st(u,d);I.status===200&&(p.value=!1,m.value=!0,h(),v.value=I.data.log)}catch{alert("Something went wrong, please try again later")}}async function R(){try{const n={activity_name:v.value.activity_name,user_id:v.value.user_id,project_id:v.value.project_id,billable:v.value.billable,start_time:v.value.start_time,end_time:U()};(await H(n,d,v.value.id)).status===200&&(m.value=!1,p.value=!0,o.value="",a.value="",c.value=!1,B(),alert("Time log added successfully"),location.reload())}catch{alert("Something went wrong, please try again later")}}return(n,_)=>(r(),i("div",Vt,[t("form",{onSubmit:O(L,["prevent"]),class:""},[w(t("input",{type:"text",class:"form-control",id:"description","aria-describedby":"description",placeholder:"What are you working on?","onUpdate:modelValue":_[0]||(_[0]=u=>o.value=u),required:""},null,512),[[x,o.value]]),Nt,l.value.length?w((r(),i("select",{key:0,id:"project",class:"form-select","onUpdate:modelValue":_[1]||(_[1]=u=>a.value=u),"aria-label":"projects",required:""},[(r(!0),i(C,null,N(l.value,u=>(r(),i("option",{key:u.id,value:u.id,textContent:f(u.project_name)},null,8,zt))),128))],512)),[[G,a.value]]):(r(),i("span",Pt," No projects. ")),t("span",{class:J(["dollar px-3 py-3",{"text-primary":c.value}]),title:c.value?"Billable":"Non billable",onClick:_[2]||(_[2]=u=>c.value=!c.value)}," $ ",10,Ft),T.value?(r(),i("span",{key:2,class:"fw-bold",textContent:f(T.value)},null,8,Ht)):g("",!0),p.value?(r(),i("button",qt," START ")):g("",!0),m.value?(r(),i("a",{key:4,onClick:R,class:"btn btn-primary text-white mb-2 mx-4 mt-2"}," STOP ")):g("",!0)],40,Kt)]))}};var Gt=F(Wt,[["__scopeId","data-v-a53790dc"]]);const Zt={setup(e){const o=Y();return o.userStatus=!1,(a,l)=>(r(),i(C,null,[$(Q),t("main",null,[$(X,{title:"Time Tracker"}),$(Gt),$(Mt)])],64))}};export{Zt as default};
