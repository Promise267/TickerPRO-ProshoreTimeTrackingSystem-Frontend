import{o as d,c as u,a as o,n as L,r as n,f as B,u as l,b as i,F as y,g as N,h as $,i as C,j as F,w as R,R as S,e as T,k as U,l as M,m as j}from"./index.38b4b252.js";import{_ as P,a as q}from"./BaseAlert.275be700.js";import{_ as I}from"./BaseFormHeading.7a2a9283.js";import{v as O}from"./validateEmail.db033d63.js";import{v as z}from"./validatePassword.7ebb3638.js";import{l as A}from"./logo.5b10267d.js";function D(m){localStorage.setItem("user",JSON.stringify(m))}const J={class:"toggle_button"},W={props:{showPassword:{type:Boolean,required:!0}},emits:["togglePassword"],setup(m,{emit:c}){function _(){c("togglePassword")}return(w,e)=>(d(),u("span",J,[o("i",{class:L(["bi toggle_icon",m.showPassword?"bi-eye":"bi-eye-slash"]),id:"showPassword",onClick:_,"data-cy":"passwordToggleIcon"},null,2)]))}};const G=["src"],H={class:"d-grid col-md-8 col-lg-5 mx-auto"},K={key:0},Q=["onSubmit"],X={class:"mb-3"},Y={class:"input_form"},Z=T("Forgot password?"),ee={class:"d-grid"},se=["disabled"],ne={setup(m){const c=U(),w=M().query.next,e=n({email:"",password:""}),g=n(""),p=n(""),r=n([]);let t=n(!1);const b=B(()=>e.value.email===""||e.value.password==="");async function x(){r.value=[],g.value="",p.value="";const{isValid:f,errorMessage:a}=O(e.value.email),{isValid:s,errorMessage:V}=z(e.value.password);if(f||(g.value=a,e.value.email=""),s||(p.value=V,e.value.password=""),r.value.length===0&&!p.value&&!g.value){const k={email:e.value.email,password:e.value.password};try{const v=await j(k),{data:h,status:E}=v;h&&E===200&&(D(h),w?c.push(w):c.push({name:"tracker"}))}catch(v){v.message==="Network Error"?r.value.push("Something went wrong, please try again later."):v.response.status===401?(r.value.push("Please enter valid email or password."),e.value.email="",e.value.password=""):(r.value.push("Could not login right now. Please try again later."),e.value.email="",e.value.password="")}}}return(f,a)=>(d(),u(y,null,[o("img",{src:l(A),alt:"Proshore Ticker logo",class:"logo"},null,8,G),o("div",H,[i(I,{title:"Log in",shortDesc:"Welcome back!"}),r.value.length?(d(),u("div",K,[(d(!0),u(y,null,N(r.value,s=>(d(),u("div",{key:s},[i(q,{message:s,"hex-font-color":"ff0000"},null,8,["message"])]))),128))])):$("",!0),o("form",{onSubmit:C(x,["prevent"])},[o("div",X,[i(P,{type:"email",name:"email",label:"Email address",modelValue:e.value.email,"onUpdate:modelValue":a[0]||(a[0]=s=>e.value.email=s),error:g.value,"data-cy":"loginEmailAddress"},null,8,["modelValue","error"]),o("div",Y,[i(P,{type:l(t)?"text":"password",name:"password",label:"Password",modelValue:e.value.password,"onUpdate:modelValue":a[1]||(a[1]=s=>e.value.password=s),error:p.value,"data-cy":"loginPassword"},null,8,["type","modelValue","error"]),i(W,{showPassword:l(t),onTogglePassword:a[2]||(a[2]=s=>F(t)?t.value=!l(t):t=!l(t))},null,8,["showPassword"])])]),i(l(S),{to:{name:"passwordForgot"},class:"forgot-password","data-cy":"loginForgetPassword"},{default:R(()=>[Z]),_:1}),o("div",ee,[o("button",{type:"submit",class:"btn btn-primary text-white",disabled:l(b),"data-cy":"loginButton"}," Log in ",8,se)])],40,Q)])],64))}};export{ne as default};
